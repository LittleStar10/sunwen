import{p as t}from"./chunk-353BL4L5-Dn_Y_Yna-DwMt6RJv.js";import{_ as e,g as a,s as n,a as i,b as r,t as o,q as l,l as s,c as p,F as c,K as d,a4 as u,e as f,z as g,H as h,Q as m,aE as x,T as y}from"./mermaid.core-CAqkCmS1-CfI52dHn.js";import{p as S}from"./treemap-75Q7IDZK-B2atdfMH-BgT2bBIv.js";import{d as w}from"./arc-Js_tyW10-CXC1QJRr.js";import{o as D}from"./ordinal-DSZU4PqD-6GfLQBXW.js";import"./index-DuGbOwWZ.js";import"./_baseUniq-BXtq6_NW-BS-TavNs.js";import"./min-BngCxx8g-CssB9raP.js";import"./clone-CEJtuQzg-GHs27P6K.js";import"./init-ZxktEp_H-C0SZ43gy.js";function C(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function $(t){return t}var A=h.pie,T={sections:new Map,showData:!1},v=T.sections,b=T.showData,k=structuredClone(A),j={getConfig:e(()=>structuredClone(k),"getConfig"),clear:e(()=>{v=new Map,b=T.showData,g()},"clear"),setDiagramTitle:l,getDiagramTitle:o,setAccTitle:r,getAccTitle:i,setAccDescription:n,getAccDescription:a,addSection:e(({label:t,value:e})=>{v.has(t)||(v.set(t,e),s.debug(`added new section: ${t}, with value: ${e}`))},"addSection"),getSections:e(()=>v,"getSections"),setShowData:e(t=>{b=t},"setShowData"),getShowData:e(()=>b,"getShowData")},M=e((e,a)=>{t(e,a),a.setShowData(e.showData),e.sections.map(a.addSection)},"populateDb"),z={parse:e(async t=>{const e=await S("pie",t);s.debug(e),M(e,j)},"parse")},_=e(t=>`\n  .pieCircle{\n    stroke: ${t.pieStrokeColor};\n    stroke-width : ${t.pieStrokeWidth};\n    opacity : ${t.pieOpacity};\n  }\n  .pieOuterCircle{\n    stroke: ${t.pieOuterStrokeColor};\n    stroke-width: ${t.pieOuterStrokeWidth};\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ${t.pieTitleTextSize};\n    fill: ${t.pieTitleTextColor};\n    font-family: ${t.fontFamily};\n  }\n  .slice {\n    font-family: ${t.fontFamily};\n    fill: ${t.pieSectionTextColor};\n    font-size:${t.pieSectionTextSize};\n    // fill: white;\n  }\n  .legend text {\n    fill: ${t.pieLegendTextColor};\n    font-family: ${t.fontFamily};\n    font-size: ${t.pieLegendTextSize};\n  }\n`,"getStyles"),B=e(t=>{const e=[...t.entries()].map(t=>({label:t[0],value:t[1]})).sort((t,e)=>e.value-t.value);return function(){var t=$,e=C,a=null,n=m(0),i=m(y),r=m(0);function o(o){var l,s,p,c,d,u=(o=x(o)).length,f=0,g=new Array(u),h=new Array(u),m=+n.apply(this,arguments),S=Math.min(y,Math.max(-y,i.apply(this,arguments)-m)),w=Math.min(Math.abs(S)/u,r.apply(this,arguments)),D=w*(S<0?-1:1);for(l=0;l<u;++l)(d=h[g[l]=l]=+t(o[l],l,o))>0&&(f+=d);for(null!=e?g.sort(function(t,a){return e(h[t],h[a])}):null!=a&&g.sort(function(t,e){return a(o[t],o[e])}),l=0,p=f?(S-u*D)/f:0;l<u;++l,m=c)s=g[l],c=m+((d=h[s])>0?d*p:0)+D,h[s]={data:o[s],index:l,value:d,startAngle:m,endAngle:c,padAngle:w};return h}return o.value=function(e){return arguments.length?(t="function"==typeof e?e:m(+e),o):t},o.sortValues=function(t){return arguments.length?(e=t,a=null,o):e},o.sort=function(t){return arguments.length?(a=t,e=null,o):a},o.startAngle=function(t){return arguments.length?(n="function"==typeof t?t:m(+t),o):n},o.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:m(+t),o):i},o.padAngle=function(t){return arguments.length?(r="function"==typeof t?t:m(+t),o):r},o}().value(t=>t.value)(e)},"createPieArcs"),O={parser:z,db:j,renderer:{draw:e((t,e,a,n)=>{s.debug("rendering pie chart\n"+t);const i=n.db,r=p(),o=c(i.getConfig(),r.pie),l=18,g=450,h=g,m=d(e),x=m.append("g");x.attr("transform","translate(225,225)");const{themeVariables:y}=r;let[S]=u(y.pieOuterStrokeWidth);S??(S=2);const C=o.textPosition,$=Math.min(h,g)/2-40,A=w().innerRadius(0).outerRadius($),T=w().innerRadius($*C).outerRadius($*C);x.append("circle").attr("cx",0).attr("cy",0).attr("r",$+S/2).attr("class","pieOuterCircle");const v=i.getSections(),b=B(v),k=[y.pie1,y.pie2,y.pie3,y.pie4,y.pie5,y.pie6,y.pie7,y.pie8,y.pie9,y.pie10,y.pie11,y.pie12],j=D(k);x.selectAll("mySlices").data(b).enter().append("path").attr("d",A).attr("fill",t=>j(t.data.label)).attr("class","pieCircle");let M=0;v.forEach(t=>{M+=t}),x.selectAll("mySlices").data(b).enter().append("text").text(t=>(t.data.value/M*100).toFixed(0)+"%").attr("transform",t=>"translate("+T.centroid(t)+")").style("text-anchor","middle").attr("class","slice"),x.append("text").text(i.getDiagramTitle()).attr("x",0).attr("y",-200).attr("class","pieTitleText");const z=x.selectAll(".legend").data(j.domain()).enter().append("g").attr("class","legend").attr("transform",(t,e)=>"translate(216,"+(22*e-22*j.domain().length/2)+")");z.append("rect").attr("width",l).attr("height",l).style("fill",j).style("stroke",j),z.data(b).append("text").attr("x",22).attr("y",14).text(t=>{const{label:e,value:a}=t.data;return i.getShowData()?`${e} [${a}]`:e});const _=512+Math.max(...z.selectAll("text").nodes().map(t=>(null==t?void 0:t.getBoundingClientRect().width)??0));m.attr("viewBox",`0 0 ${_} 450`),f(m,g,_,o.useMaxWidth)},"draw")},styles:_};export{O as diagram};
